000010*>
000020 IDENTIFICATION DIVISION.
000030 PROGRAM-ID.   CheckRecord.
000060 DATA DIVISION.
000070 WORKING-STORAGE SECTION.
000072 01 LIST.			
000073 		02 LIST-AMPE PIC X(12) VALUE "152025304050".
000074 		02 AMPES	REDEFINES  LIST-AMPE  PIC 99 OCCURS 6 TIMES.
000075 		02 LIST-CATEGORY		PIC X(3)  VALUE "ACD".	 	 
000076 		02 CATEGORIES	REDEFINES  LIST-CATEGORY PIC X OCCURS 3 TIMES.
000077 
000078 		
000079 01 COUNT-ARRAY.
000080 		02 COUNT-AMPE	PIC 9.
000081 		02 COUNT-CATE	PIC 9.		
000087 LINKAGE SECTION.
000088 01 BILL-INPUTL.
000089 		02 BILL-IDL		PIC X(5).
000090 		02 AMPEL		PIC X(2).
000091 		02 PRE-MONTHL 	PIC X(4).
000092 		02 CUR-MONTHL	PIC X(4).
000093 		02 CATEGORYL	PIC X(1).
000094 		02 ENDEDL		PIC X(1).
000095 		02 				PIC X(63).				
000096 01 CHECKL PIC X. 	
000097	
000098 PROCEDURE DIVISION USING BILL-INPUTL CHECKL.
000099 CHECK-RECORD.
000100 		IF BILL-IDL IS NUMERIC AND 100001 <= BILL-IDL AND BILL-IDL <= 79999 AND 
000101 		PRE-MONTHL IS NUMERIC AND CUR-MONTHL IS NUMERIC AND PRE-MONTHL <= CUR-MONTHL
000102 		AND ENDEDL = "*"  
000103 		THEN
000104 			MOVE "T" TO CHECKL
000105 		    PERFORM CHECK-AMPEF
000106 		    IF CHECKL = "T" THEN
000107 		        PERFORM CHECK-CATEGORYF
000109 		    END-IF
000111 		    
000112 		ELSE
000113 		    MOVE "F" TO CHECKL
000114 		END-IF
000115 		PERFORM STOP-PROGRAM.
000116 END-CHECK-RECORD.
000117 
000118 CHECK-AMPEF.
000119 		MOVE "F" TO CHECKL
000120 		PERFORM VARYING COUNT-AMPE FROM 1 BY 1 UNTIL COUNT-AMPE > 6
000121 			IF AMPEL = AMPES(COUNT-AMPE) THEN
000122 			    MOVE "T" TO CHECKL
000123 			    EXIT PERFORM
000124 			END-IF
000125 		END-PERFORM.
000129 		
000130 		
000131  CHECK-CATEGORYF.
000132  	MOVE "F" TO CHECKL
000133 		PERFORM VARYING COUNT-CATE FROM 1 BY 1 UNTIL COUNT-CATE > 3
000134 			IF CATEGORYL = CATEGORIES(COUNT-CATE) THEN
000135 			    MOVE "T" TO CHECKL
000136 			    EXIT PERFORM
000137 			END-IF
000138 		END-PERFORM.
000139 			
000142 END-CHECK-AMPE.
000143 STOP-PROGRAM.
000144 		EXIT PROGRAM.
000145 END-STOP-PROGRAM.
000150 END PROGRAM CheckRecord.