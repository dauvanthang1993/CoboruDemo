000010*>
000020 IDENTIFICATION DIVISION.
000030 PROGRAM-ID.   Example2.
000040 ENVIRONMENT    DIVISION.
000050 CONFIGURATION  SECTION.
000051 INPUT-OUTPUT SECTION.
000052 FILE-CONTROL.
000053 		SELECT BILL-INPUTF ASSIGN TO "INPUT.txt"
000054      ORGANIZATION IS LINE SEQUENTIAL.
000055      SELECT BILL-LISTF ASSIGN TO PRINTER.
000057      SELECT BILL-TAPEF ASSIGN TO "OUTTAP.txt"
000058      ORGANIZATION IS LINE SEQUENTIAL.
000059      
000060 DATA DIVISION.
000061 FILE SECTION.
000062 FD BILL-INPUTF.
000063 01 BILL-INPUT.
000064 		02 BILL-ID		PIC X(5).
000065 		02 AMPE			PIC X(2).
000066 		02 PRE-MONTH 	PIC X(4).
000067 		02 CUR-MONTH	PIC X(4).
000068 		02 CATEGORY		PIC X(1).
000069 		02 ENDED		PIC X(1).
000070 		02				PIC X(63).
000071 	
000072 FD BILL-LISTF.
000073 01 BILL-LIST.
000074 		02 LIST-WRITE	PIC X(120).
000075 FD BILL-TAPEF.
000076 01 BILL-TAPE.
000077 		02 TAP-WRITE	PIC X(100).
000078  
000079 
000080 		
000081 WORKING-STORAGE SECTION.
000082 01 CHECK.
000083 		02 CHECK-EOF 	PIC X 	VALUE "F".
000084 		02 CHECK-RECORD PIC X.
000085 01 BILL-LIST-DISPLAY.
000086 		02 				PIC X(9) VALUE SPACE.
000087 		02 ORDER-L		PIC zz9  BLANK WHEN ZERO.
000088 		02				PIC X(6) VALUE SPACE.		
000089 		02 ERROR-L		PIC X(3).
000090 		02      		PIC X(8) VALUE SPACE.
000091 		02 BILL			PIC X(80).
000092 						
000093 01 BILL-TAPE-DISPLAY.
000094 		02 				PIC X(9) VALUE SPACE.
000095 		02 BILL-IDT		PIC X(5).
000096 		02 				PIC X(2) VALUE SPACE.
000097 		02 AMPET		PIC X(2).
000098 		02 				PIC X(2) VALUE SPACE.
000099 		02 PRE-MONTHT 	PIC X(4).
000100 		02 				PIC X(2) VALUE SPACE.
000101 		02 CUR-MONTHT	PIC X(4).
000102 		02				PIC X(2) VALUE SPACE.
000103 		02 CATEGORYT	PIC X(1).
000104 		
000105 01 LIST-TITLE.
000106 		02				PIC X(10) VALUE SPACE.
000107 		02				PIC X(2)  VALUE "NO".
000108 		02				PIC X(5)	VALUE 	SPACE.
000109 		02 				PIC X(5)	VALUE "ERROR".
000110 		02				PIC X(8)	VALUE SPACE.
000111 		02				PIC X(41)	VALUE "* * Electricity Usage List * * ".
000112 		
000113 01 BILL-TITLE.
000114 		02				PIC X(17)	VALUE SPACE.
000115 		02				PIC X(41)	VALUE "* * Electricity Usage List * * ".		
000116 01 COUNT-VALUE.
000117 		02 COUNT-RECORD PIC 9(3) VALUE 0.
000118 		02 COUNT-NEXTPAGE	PIC 9(2) VALUE 0.		
000119 		
000120 PROCEDURE DIVISION.
000121 MAIN-PROGRAM.
000122 		PERFORM INIT-PROGRAM
000123 		PERFORM MAIN-PROCESS UNTIL CHECK-EOF = "T"
000124 		PERFORM END-PROGRAM
000125 		STOP RUN.
000126 END-MAIN-PROGRAM.
000127**************************** 
000128 INIT-PROGRAM.
000129 		OPEN INPUT BILL-INPUTF
000130 		OPEN OUTPUT BILL-LISTF BILL-TAPEF
000131 		WRITE BILL-LIST FROM BILL-TITLE AFTER 5 LINE.
000132 		WRITE BILL-LIST FROM LIST-TITLE AFTER 2 LINE.
000133 		PERFORM INPUT-BILLF.
000134************************** 		
000135 MAIN-PROCESS.
000136 		COMPUTE COUNT-RECORD = COUNT-RECORD + 1
000137 		COMPUTE COUNT-NEXTPAGE = COUNT-NEXTPAGE + 1
000138 		CALL "CheckRecord"  USING BILL-INPUT CHECK-RECORD.
000139 		IF CHECK-RECORD = "T" THEN
000140 		    PERFORM WRITE-BILL-TAPE
000143 		END-IF
000144		PERFORM WRITE-BILL-LIST
000145		PERFORM INPUT-BILLF.
000146 END-MAIN-PROCESS.
000147************************** 
000148 END-PROGRAM.
000149 		CLOSE BILL-INPUTF
000150 		CLOSE BILL-LISTF BILL-TAPEF.
000151 END-END-PROGRAM.
000152************************* 
000153 INPUT-BILLF.
000154		 READ BILL-INPUTF
000155		         AT END 
000156		         	MOVE "T" TO CHECK-EOF
000157		 END-READ.
000158 END-INPUT-BILLF.  
000159 
000160*************************** 
000161 WRITE-BILL-LIST.
000162 		MOVE COUNT-RECORD TO ORDER-L
000163 		IF CHECK-RECORD = "F" THEN
000164 		    MOVE "-*-" TO ERROR-L
000165 		ELSE
000166 			MOVE "   " TO ERROR-L    
000167 		END-IF
000168 		
000169 		MOVE BILL-INPUT TO BILL
000170 		WRITE BILL-LIST FROM BILL-LIST-DISPLAY AFTER 2 LINE
000171 		
000172 		IF COUNT-NEXTPAGE = 10 THEN
000173 			MOVE 0 TO COUNT-NEXTPAGE
000174 		    PERFORM WRITE-HEAD-PAGE
000175 		END-IF.
000176 END-WRITE-BILL-LIST.
000177*
000178***************************
000179 WRITE-BILL-TAPE.
000180 	    MOVE BILL-ID TO BILL-IDT
000182 		MOVE AMPE TO AMPET
000183 		MOVE PRE-MONTH TO PRE-MONTHT
000184 		MOVE CUR-MONTH TO CUR-MONTHT
000185 		MOVE CATEGORY TO CATEGORYT
000186 		WRITE BILL-TAPE FROM BILL-TAPE-DISPLAY.	
000187 END-WRITE-BILL-TAPE.
000188*
000189
000190
000191*******************************
000192 WRITE-HEAD-PAGE.
000193 	   MOVE SPACE TO BILL-LIST
000194 	   WRITE BILL-LIST AFTER PAGE
000195 	   WRITE BILL-LIST FROM BILL-TITLE AFTER 4 LINE
000196 	   WRITE BILL-LIST FROM LIST-TITLE AFTER 2 LINE.			
000197 END-WRITE-HEAD-PAGE.
000198*
000199 END PROGRAM Example2.